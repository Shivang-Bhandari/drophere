// Generated by CoffeeScript 1.4.0
var fs, service;

service = require('../lib/service');

fs = require('fs');

exports.upload = function(req, res) {
  var file, ret_val, s, subtype, type, _ref;
  file = req.files.file;
  _ref = file.type.split("/", 1), type = _ref[0], subtype = _ref[1];
  if (type === 'image') {
    s = new service.ImgurService;
  } else {
    s = new service.PastebinService;
  }
  return ret_val = s.dispatch(file, function(error, filename, url, message) {
    var resp;
    resp = {
      error: error,
      filename: filename,
      url: url,
      message: message
    };
    return res.send(resp);
  });
};
